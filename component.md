# Компонент

Один из подходов в веб-разработке \(и вообще в разработке программного обеспечения\) -
это компонентная архитектура. В последние годы она приобрела большую популярность. Что такое компонент?

В [Service-Oriented Architecture \(SOA\) vs. Component Based Architecture](http://petritsch.co.at/download/SOA_vs_component_based.pdf),
Хельмут Петрич определяет компонент следующим образом:

> Компонент представляет собой программный объект, предназначенный для взаимодействия с другими
компонентами, инкапсулирующий определенную функциональность или набор функциональностей. Компонент
имеет четко определенный интерфейс и соответствует предписанному поведению, характерному
для всех компонентов в архитектуре.

В веб-приложениях **компонент управляет частью экрана, которая называется представление**. Это то,
что вы в конечном итоге увидите на экране. Он имеет шаблон, который определяет его
визуальную структуру, а также логику, которая определяет поведение и динамические
значения. Логической частью является код JavaScript и это называется контроллером.

Вот диаграмма компонента в Angular-е, с приведенным ниже результатом.

Директивы, фильтры и сервисы - это другие строительные блоки в Angular, которые могут использоваться
в компоненте \(на диаграмме мы видим только использование фильтров\). Мы обсудим их позже в туториале.

Давайте рассмотрим компонент, созданный с помощью Angular CLI. Все соответствующие файлы
находятся в папке `src/app`. Откройте файл `app.component.ts`.

Так же, как и ngModules, которые мы видели в предыдущей главе, компонент определяется классом с декоратором.
Это определение класса:

{% code-tabs %}
{% code-tabs-item title="src/app/app.component.ts" %}
```typescript
export class AppComponent {
  title = 'app';
}
```
{% endcode-tabs-item %}
{% endcode-tabs %}

У него есть одно свойство, которое называется "title". Это свойство, которому вы можете присвоить значение.
"app" - это значение, которое присвоили данному свойству.

Angular обеспечивает синхронизацию свойств компонента с его шаблоном. Поэтому мы
можем легко использовать элемент `title` в шаблоне. Взгляните на шаблон, прикрепленный к
компоненту в файле `app.component.html`. В верхней части вы увидите следующий код:

{% code-tabs %}
{% code-tabs-item title="src/app/app.component.html" %}
```markup
<h1>
  Welcome to {{ title }}!
</h1>
```
{% endcode-tabs-item %}
{% endcode-tabs %}

Двойные фигурные скобки и их содержимое называется **Интерполяция**. Это одна из форм **привязки данных** в
Angular. Как уже упоминалось ранее, код в этом файле не используется в момент, когда браузер отображает
компонент. Сначала Angular компилирует его в JavaScript код. На одном из этапов компиляции он ищет интерполяции
внутри шаблона. Содержимое интерполяции является "шаблонным выражением Angular-а" \(что очень похоже на JavaScript\).
Выражение определяется во время выполнения, а затем вы видите результат.

Интерполяция - самая основная и одна из самых важных функциональностей в Angular-е. Она существует с самого
начала Angular - в первой версии \(AngularJS\). Интерполяция позволяет очень просто вставить динамические данные в представление.

В этом компоненте выражение `title` просто является свойством класса компонента. **Попробуем изменить его.**
Выполните шаги, указанные ниже и посмотрите результат в браузере. \(При каждом изменении, которое вы делаете в файле,
браузер будет автоматически обновляться!\)

* Удалите фигурные скобки и оставьте только содержимое `title`.
* Верните фигурные скобки назад и замените содержимое некоторым математическим выражением,
например: `{{2 + 2}}`. \(Пробелы не являются обязательными, они просто делают код более читабельным.\)
* Напишите математическое выражение в сочетании со свойством `title`: `{{title + 10}}`
* Передайте неопределенную переменную, которая не была объявлена в классе компонента, в выражение.
Например: `{{x}}`
* Попробуйте все, что угодно. Не беспокойтесь - вы не можете навредить браузеру или компьютеру!
В худшем случае у браузера не хватит памяти и он зависнет. \(Но вам нужно написать что-то действительно сложное,
чтобы это произошло!\)

Это один из способов, которым вы можете привязать переменные, объявленные в контроллере компонента, к его шаблону.
Как же именно Angular понимает, что этот шаблон принадлежит к App компоненту?

Давайте вернемся к файлу `app.component.ts` и посмотрим на метаданные компонента, которые
определены в декораторе `@Component`, прямо над объявлением класса:

{% code-tabs %}
{% code-tabs-item title="src/app/app.component.ts" %}
```typescript
@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})
```
{% endcode-tabs-item %}
{% endcode-tabs %}

Мы передаем объект с описанием декоратору, точно так же, как мы видели в предыдущей главе с ngModule.
Второе свойство, `templateUrl`, сообщает Angular-у, где искать шаблон, прикрепленный к компоненту.
Есть еще один вариант как указать шаблон - написать его внутри самого компонента. Данный способ мы обсудим позже.

Третье свойство `styleUrls` сообщает Angular-у, где искать CSS файлы, которые определяют стиль этого компонента.
Он может иметь несколько файлов CSS. Вот почему значение `styleUrls` является массивом. Вы можете посмотреть
файл CSS `app.component.css` - он пуст. Здесь вы можете добавить свои стили, например:

{% code-tabs %}
{% code-tabs-item title="src/app/app.component.css" %}
```css
h1 {
  color: red;
}
```
{% endcode-tabs-item %}
{% endcode-tabs %}

Позднее мы добавим больше стилей.

**Примечание:** Angular CLI поддерживает препроцессоры из коробки: sass, less и stylus.

Первое свойство, `selector`, сообщает Angular, какое будет имя у тега, который мы будем использовать для вызова
компонента. Как мы видели в файле `src/index.html`, мы используем App компонент внутри body:

{% code-tabs %}
{% code-tabs-item title="src/index.html" %}
```markup
<body>
  <app-root></app-root>
</body>
```
{% endcode-tabs-item %}
{% endcode-tabs %}

`app-root` не является HTML элементом. Это компонент, который был создан с помощью селектора
`app-root`. Попробуйте изменить селектор. Вы увидите, что если вы измените его только в одном из файлов,
ничего не будет отображаться, так как элемент больше не заменяется Angular компонентом. Также вы можете увидеть
сообщение об ошибке в консоли браузера.

Последнее: первая строка в файле компонента импортирует код, который определяюет декоратор `@Component`.
Он необходим, чтобы использовать декоратор, который определен в импортированном файле \(или фактически,
в одном из своих собственных импортов\). Попробуйте удалить эту строку и вы увидите ошибку.

## Инлайновый шаблон

Давайте переместим шаблон во **внутрь** компонента. Это поможет нам управлять шаблоном,
глядя на его функциональность. В файле `app.component.ts` замените строку

{% code-tabs %}
{% code-tabs-item title="src/app/app.component.ts" %}
```typescript
templateUrl: './app.component.html',
```
{% endcode-tabs-item %}
{% endcode-tabs %}

на

{% code-tabs %}
{% code-tabs-item title="src/app/app.component.ts" %}
```typescript
template: ``,
```
{% endcode-tabs-item %}
{% endcode-tabs %}

Обратите внимание на **обратные ковычки** - **\`** - они используются для определения шаблоных строк,
которые являются новой функциональностью в JavaScript \(ES6\). Таким образом, вы можете определить переменные,
занимающие несколько строк. У них есть еще одна классная способность - внутри такой строки легко использовать JavaScript
переменные и выражения \(без связи с Angular выражениями в шаблоне\). Более подробно об это вы можете
прочитать по ссылке [MDN documentation](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals).

Убедитесь, что вы заменили `templateUrl` на` template`, и не забудьте поставить запятую в конце строки.

Теперь вместо того, чтобы брать содержимое из исходного шаблона, мы добавим более простой шаблон, с которым мы
можем работать. Когда курсор находится между обратными ковычками, нажмите Enter и вставьте HTML шаблон:

{% code-tabs %}
{% code-tabs-item title="src/app/app.component.ts" %}
```markup
template: `
  <h1>
    Welcome to {{ title }}!
  </h1>  
`,
```
{% endcode-tabs-item %}
{% endcode-tabs %}

Управлять шаблоном проще, когда вы видите одновременно его контроллер. Именно так, пока шаблон не становится
слишком большим, а контроллер не становится слишком сложным. Если такое произошло, то в этом случае вы должны
реорганизовать свой код, разбив его на дочерние компоненты.

На данном этапе вы можете удалить файл `app.component.html`.

**Мы рекомендуем продолжить этот туториал, используя инлайновые шаблоны в компонентах.** Особенно, если вы работаете
на ноутбуке с небольшим экраном, где недостаточно места для открытия двух файлов рядом.

Давайте сконфигурируем Angular CLI так, чтобы инлайновый шаблон использовался по умолчанию. В терминале необходимо выполнить
команду: `ng set defaults.component.inlineTemplate true`. Теперь каждый компонент, который вы создадите, будет иметь
инлайновый шаблон, и HTML-файл не будет создан.

Если вы хотите продолжить этот туториал, использую шаблоны в отдельных HTML файлах, то просто не запускайте эту команду
и используйте сгенерированные файлы `.html`.

> **Примечание:** Вы можете указать, что вы хотите использовать инлайновый шаблон во всем проекте несколькими способами:
>
> * При создании проекта укажите флаг `-it` или` -inline-template` следующим образом: `ng new todo-list -it`
> * После создания проекта добавьте его в конфигурацию, чтобы сформированные компоненты с этого момента имели
инлайновый шаблон: `ng set defaults.component.inlineTemplate true`. \(Начиная с версии 6 вам нужно будет использовать
команду `ng config projects.YOURPROJECTNAME.schematics.@schematics/angular:component.inlineTemplate true`\). Это добавляет
строку` inlineTemplate: true` в конфигурационном файле Angular CLI `.angular-cli.json` \(` angular.json` в версии 6\).
Вы также можете редактировать файл напрямую.
> * Если вы не настроили инлайновые шаблоны по умолчанию, вы можете указать это для каждого компонента при его создании,
использовав флаг `-it` или` --inline-template`. Например: `ng generate header -it`.

Точно так же мы используем инлайновый шаблон, мы можем использовать также встроенные стили. Но пока мы сохраним их в
отдельном файле.

## Итог

В этой главе мы изучили корневой компонент, который был сгенерирован нами с помощью Angular CLI, и даже немного изменили его. В следующей
главе мы создадим новый компонент и начнем строить дерево компонентов, которое определяет структуру приложения.


